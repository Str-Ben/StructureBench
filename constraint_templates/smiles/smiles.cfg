
start: smiles

# SMILES: one or more PIECE
smiles: piece piece_tail
piece_tail: piece piece_tail |

# PIECE: a SMILES "token-like" chunk
piece: BRACKET_ATOM
    | ELEMENT
    | AROM
    | DIGITS
    | BOND
    | DOT
    | BRANCH_OPEN
    | BRANCH_CLOSE
    | PERCENT

# ----- Regex terminals -----
# Bracket atom: e.g. [O-], [N+], [13C], [C@H], [nH+]
# We intentionally do not parse internal structure; just keep it bracketed and non-whitespace.
BRACKET_ATOM: /\[[^\[\]\s()]+\]/

# Element symbols: prefer common two-letter halogens first, then general [A-Z][a-z]?
ELEMENT: /Cl|Br|[A-Z][a-z]?/

# Aromatic atoms
AROM: /[bcnops]/

# Digits (ring closures, isotopes outside brackets in some rare cases)
DIGITS: /[0-9]+/

# Bonds and stereochemistry markers
# include backslash and slash
BOND: /[-=#:]/ | "/" | "\\"

DOT: "."
PERCENT: "%"
BRANCH_OPEN: "("
BRANCH_CLOSE: ")"
