root ::= expr

# LaTeX math (subset) in EBNF style aligned with penman.ebnf
# - Compact output preferred; optional single spaces allowed via ws
# - Covers: + - * / =, ^, _{...}, parentheses/brackets/braces groups
# - Covers: \frac{a}{b}, \sqrt{...}, \sqrt[n]{...}
# - Covers: trig/log/ln/exp function calls, Greek letters, identifiers, numbers

expr ::= sum expr_tail*
expr_tail ::= "=" sum

sum ::= prod sum_tail*
sum_tail ::= add_op prod
add_op ::= "+" | "-"

prod ::= pow prod_tail*
prod_tail ::= mul_op pow
mul_op ::= "*" | "/" | "\\cdot"

pow ::= unary pow_tail*
pow_tail ::= "^" group

unary ::= add_op unary | atom

atom ::= base subsup

subsup ::= sub sup | sup sub | 
sub ::= "_" group | 
sup ::= "^" group | 

# grouping
group ::= "{" expr "}"
        | "(" expr ")"
        | "[" expr "]"
        | base

# base units
base ::= number
      | ident
      | greek
      | const
      | func_call
      | frac
      | sqrt
      | paren_expr

paren_expr ::= "(" expr ")"

frac ::= "\\frac" "{" expr "}" "{" expr "}"

sqrt ::= "\\sqrt" sqrt_opt "{" expr "}"
sqrt_opt ::= "[" expr "]" | 

func_call ::= func func_arg
func ::= "\\sin" | "\\cos" | "\\tan" | "\\cot" | "\\sec" | "\\csc" | "\\log" | "\\ln" | "\\exp"
func_arg ::= group | base

const ::= "i" | "e" | "\\pi"

# terminals
number ::= digits ("." digits)?
digits ::= digit+
digit ::= "0"|"1"|"2"|"3"|"4"|"5"|"6"|"7"|"8"|"9"

ident ::= letter (letter | digit)*
letter ::= [a-z] | [A-Z]

greek ::= "\\alpha"|"\\beta"|"\\gamma"|"\\delta"|"\\epsilon"|"\\zeta"|"\\eta"|"\\theta"|"\\iota"|"\\kappa"|"\\lambda"|"\\mu"|"\\nu"|"\\xi"|"\\omicron"|"\\pi"|"\\rho"|"\\sigma"|"\\tau"|"\\upsilon"|"\\phi"|"\\chi"|"\\psi"|"\\omega"

